# Repositorios Instancia
---

- name: Directorio repositorios instancia
  become: True
  file: path={{ path_repos_instancia }} state=directory
  tags:
    - reposinstancia
    - repos

- name: Clonar repsitorios instancia
  become: True
  git:
    repo: "{{ item.url }}" 
    depth: 1 
    dest: "{{ path_repos_instancia }}/{{ item.name }}" 
    version: "{{ item.version }}"
    key_file: "{{ item.keyfile }}"
    ssh_opts: "{{ item.ssh_opts}}"
    accept_hostkey: yes
    # Using force because of pyc files. They are in .gitignore but ansible
    # doesn't care
    force: yes
  with_items: "{{ repositorios_instancia }}"
  tags:
    - reposinstancia
    - repos

- name: Permisos repositorios
  become: True
  file: path={{ path_repos_instancia }} state=directory
        owner={{ odoo_user }} group={{ odoo_user }} recurse=yes
  tags:
    - reposinstancia
    - repos

