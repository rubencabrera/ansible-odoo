---

# Tareas para la creación y gestión de los repositorios de la comunidad.

# Comunidad
- include_vars: ../vars/repos.yml

- name: Directorio repositorios oca
  file: path={{ path_repos_oca }} state=directory

- name: Clonar repsitorios oca
  git:
    repo: "{{ item.url }}" 
    depth: 1 
    dest: "{{ path_repos_oca }}/{{ item.name }}" 
    version: "8.0"
  with_items: "{{ repositorios_oca }}"

- name: Permisos repositorios
  file: path={{ path_repos_oca }} state=directory
        owner={{ odoo_user }} group={{ odoo_user }} recurse=yes


# Instancia
# Definimos la ruta al fichero yml de los repos de instancia en el inventario
- include_vars: "{{ ruta_repos_instancia }}"

- name: Directorio repositorios instancia
  file: path={{ path_repos_instancia }} state=directory

- name: Clonar repsitorios instancia
  git:
    repo: "{{ item.url }}" 
    depth: 1 
    dest: "{{ path_repos_instancia }}/{{ item.name }}" 
    version: "{{ item.version }}"
  with_items: "{{ repositorios_instancia }}"

- name: Permisos repositorios
  file: path={{ path_repos_instancia }} state=directory
        owner={{ odoo_user }} group={{ odoo_user }} recurse=yes

